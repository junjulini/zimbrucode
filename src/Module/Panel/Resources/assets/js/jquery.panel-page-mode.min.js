(()=>{"use strict";const e=jQuery;class t{constructor(){this.global=zc.getModuleData("panel")}scrollbarTop(){e(".zc-panel .zc-scrollbar").scrollTop(0)}calcHeight(){this.getCache("wp-body-height")!==e(window).height()&&this.addCache("wp-body-height",e(window).height())}eraseMobileMenu(){this.isDesktopMode()?!0===this.service("menu/isSubmenuItem")&&(e(".zc-panel-menu").addClass("zc-panel-menu_submenu-active"),e(".zc-panel-content").addClass("zc-panel-content_submenu-active")):(e(".zc-panel-menu").removeClass("zc-panel-menu_submenu-active"),e(".zc-panel-content").removeClass("zc-panel-content_submenu-active")),e(".zc-panel-content").removeClass("zc-panel-content_mobile-menu-visible"),e(".zc-panel-header__controller-button_type_mobile-menu").removeClass("zc-panel-header__controller-button_type_mobile-menu_active"),this.service("close-block").hideDefinitely()}isDesktopMode(){return e(".zc-panel").width()>=this.getConfig("min-size/mode2")}errorCheck(t,n){e(".zc-popup").hasClass("zc-panel-error-confirm")||(e(".zc-popup").length&&e(".zc-popup").remove(),console.error(n),zc.confirm({title:t,subject:`${n} <br> Page will be reloaded, ok?`,class:"zc-panel-error-confirm",ok:()=>{location.reload()}}))}getVar(e,t){const n=zc.deepFindAndSetting(this.global.vars,e);return void 0!==n?n:t}addVar(e,t){zc.deepFindAndSetting(this.global.vars,e,t)}addCache(e,t){zc.deepFindAndSetting(this.global.cache,e,t)}getCache(e,t){const n=zc.deepFindAndSetting(this.global.cache,e);return void 0!==n?n:t}remCache(e){zc.deepFindAndSetting(this.global.cache,e,!1,!0)}addConfig(e,t){zc.deepFindAndSetting(this.global.config,e,t)}getConfig(e,t){const n=zc.deepFindAndSetting(this.global.config,e);return void 0!==n?n:t}service(t,n){if(void 0!==t&&"string"==typeof t){if(!e.isFunction(n)&&"object"!=typeof n){const e=this.getCache(`services/${t}`,!1);if(void 0!==e)return e;throw new Error(`Next service not exist : ${t}`)}this.addCache(`services/${t}`,n)}}on(t,n,i,o=!1){e(".zc-panel").on(t,n,(t=>{!0===o&&t.preventDefault(),i(e(t.currentTarget),t)}))}click(e,t,n=!0){this.on("click",e,t,n)}}const n=jQuery;class i extends t{constructor(){super(),this.calcPanelHeight(),this.calcPanelWidth();let e=window.innerWidth,t=window.innerHeight;n(window).on("resize.zc-panel",(()=>{window.innerWidth!=e&&(e=window.innerWidth,this.eraseMobileMenu(),this.calcPanelHeight()),this.isDesktopMode()&&window.innerHeight!=t&&(t=window.innerHeight,this.calcHeight(),this.calcPanelHeight())}))}calcPanelHeight(){this.isDesktopMode()?(n(".zc-panel-controls").height("auto"),n(".zc-panel-submenu__scrollbar-container").height("auto")):(n(".zc-panel-controls").height("100%"),n(".zc-panel-submenu__scrollbar-container").height("100%"))}calcPanelWidth(){new ResizeObserver((e=>{void 0!==e[0]&&this.addModeSize(e[0].contentRect.width)})).observe(n(".zc-panel").get(0))}addModeSize(e){let t="mode-1-";t=this.getConfig("min-size/mode1")>=e?"mode-1-":this.getConfig("min-size/mode2")>=e?"mode-2-":"mode-3-",n(".zc-panel").attr("data-width",t+e),n(window).trigger("zc/panel/size-changed")}}const o=jQuery;class c extends t{constructor(){super(),this.timer1=!1,this.timer2=!1,this.type="error",this.title="Error",this.content="General error ( AJAX / LOGIN / PHP Error )",this.duration=3e3,this.callback=()=>{}}add(e,t,n,i,c){e=e||this.type,t=t||this.title,n=n||this.content,i=i||this.duration,c=c||this.callback,clearTimeout(this.timer1),clearTimeout(this.timer2);const a=zc.tpl(' <div class="zc-panel-direct-notification zc-panel-direct-notification_type_{{type}}"> <div class="zc-panel-direct-notification__icon-container"> <i class="zc-panel-direct-notification__icon"></i> </div> <div class="zc-panel-direct-notification__content"> <span class="zc-panel-direct-notification__title">{{title}}</span> <p class="zc-panel-direct-notification__text">{{content}}</p> </div> <div class="zc-panel-direct-notification__close-controller"> <i class="zc-panel-direct-notification__close-icon zc-icon-clear"></i> </div> </div>',{type:e,title:t,content:n});o(".zc-panel .zc-panel-direct-notification").remove(),o(".zc-panel .zc-panel-controls").prepend(a),this.click(".zc-panel-direct-notification__close-controller",(()=>{clearTimeout(this.timer1),clearTimeout(this.timer2),o(".zc-panel .zc-panel-direct-notification").addClass("zc-panel-direct-notification_close"),this.timer2=setTimeout((()=>{o(".zc-panel .zc-panel-direct-notification").remove()}),300),c()})),this.timer1=setTimeout((()=>{o(".zc-panel .zc-panel-direct-notification").addClass("zc-panel-direct-notification_close"),this.timer2=setTimeout((()=>{o(".zc-panel .zc-panel-direct-notification").remove()}),300),c()}),i)}}const a=jQuery;class s extends t{constructor(){super(),this.dn=new c,this.tpl=' <div class="zc-panel-popup-notification zc-panel-popup-notification_type_{{type}}"> <div class="zc-panel-popup-notification__icon-container"> <i class="zc-panel-popup-notification__icon"></i> </div> <div class="zc-panel-popup-notification__content-container"> <div class="zc-panel-popup-notification__content"> <span class="zc-panel-popup-notification__title">{{title}}</span> <p class="zc-panel-popup-notification__text">{{content}}</p> </div> <div class="zc-panel-popup-notification__close-controller"> <button class="zc-panel-popup-notification__close-button" type="button">{{var_exit}}</button> </div> </div> </div>',this.setNotificationPosition(),this.save(),this.reset()}setNotificationPosition(){a(window).on("scroll zc/panel/size-changed zc/panel/save/success-end",(()=>{if(a(".zc-panel").width()<=this.getConfig("min-size/mode2")){const e=a(".zc-panel .zc-panel-header").position().top||0;e>0&&a(".zc-panel .zc-panel-direct-notification").css("top",e+56)}else a(".zc-panel .zc-panel-direct-notification").attr("style","")}))}showLoading(){a(".zc-panel-save-starter-button").hide(),a(".zc-panel-loading-starter-button").css("display","flex"),a(".zc-panel-reset-starter-button").prop("disabled",!0).addClass("zc-panel-header__controller-button_disabled")}hideLoading(){a(".zc-panel-save-starter-button").css("display","flex"),a(".zc-panel-loading-starter-button").hide(),a(".zc-panel-reset-starter-button").prop("disabled",!1).removeClass("zc-panel-header__controller-button_disabled")}save(){this.click(".zc-panel-save-starter-button",(e=>{this.showLoading(),a(window).trigger("zc/panel/save/start");const t={};t.procOptions=()=>{const e={};return a(".zc-panel .zc-panel-controls [data-option]").each(((t,n)=>{let i=a(n).attr("name");if("i"==a(n).data("i"))return;if(void 0===i)return;i=i.replace(/\[\]/g,""),i=i.replace(this.getVar("prefix-slug"),"");const o=a(n).val();a(n).is(":radio")||a(n).is(":checkbox")?a(n).is(":checked")&&(e[i]=o):e[i]=o})),e},zc.jsonRequest(`zc/module/panel/save_${this.getVar("slug")}`,this.getVar("nonce"),{options:t.procOptions()}).then((e=>{a(window).trigger("zc/panel/save/success-start");const t=void 0===e.reload?void 0:()=>{location.reload()};this.dn.add(e.type,e.title,e.content,3e3,t),this.hideLoading(),"success"===e.type&&(this.addCache("changed",!1),a(window).trigger("zc/panel/save/success-response")),a(window).trigger("zc/panel/save/success-end")})).catch((e=>{a(window).trigger("zc/panel/save/error"),this.errorCheck("Panel : Save options",e)})),a(window).trigger("zc/panel/save/end")}))}reset(){this.click(".zc-panel-reset-starter-button",(()=>{a(window).trigger("zc/panel/reset/start"),zc.confirm({title:this.getVar("reset-popup-title"),subject:this.getVar("reset-popup-subject"),titleOK:this.getVar("reset-popup-ok"),titleCancel:this.getVar("reset-popup-cancel"),ok:e=>{e.hideContent(),a(window).trigger("zc/panel/reset/before"),zc.jsonRequest(`zc/module/panel/reset_${this.getVar("slug")}`,this.getVar("nonce")).then((t=>{a(window).trigger("zc/panel/reset/success-start"),"success"===t.type?(e.remContent(),e.appendContent(zc.tpl(this.tpl,{type:t.type,title:t.title,content:t.content})),e.showContent(),setTimeout((()=>{location.reload()}),2e3),this.addCache("changed",!1),a(window).trigger("zc/panel/reset/success-success")):"info"===t.type?(e.remContent(),e.appendContent(zc.tpl(this.tpl,{type:t.type,title:t.title,content:t.content,var_exit:this.getVar("exit")})),e.showContent(),a(window).trigger("zc/panel/reset/success-info")):(e.remContent(),e.appendContent(zc.tpl(this.tpl,{type:"error",title:"Error",content:"AJAX / LOGIN / PHP Error",var_exit:this.getVar("exit")})),e.showContent(),a(window).trigger("zc/panel/reset/success-error")),a(".zc-popup").on("click",".zc-panel-popup-notification__close-button",(t=>{t.preventDefault(),e.close()})),a(window).trigger("zc/panel/reset/success-end")})).catch((e=>{a(window).trigger("zc/panel/reset/error"),this.errorCheck("Panel : Reset options",e)}))}}),a(window).trigger("zc/panel/reset/end")}))}}const l=jQuery;class r extends t{constructor(){super(),this.starterButton(),this.closeBlock()}starterButton(){this.click(".zc-panel-quick-links-starter-button",(e=>{const t=parseInt(l(".zc-panel-header__controllers_right").width()),n=parseInt(e.outerWidth()),i=t-parseInt(e.position().left)-n+parseInt(l(".zc-panel-header").css("padding-right"));l(".zc-panel-quick-links").css("right",i),e.hasClass("zc-panel-quick-links-starter-button_active")?(e.removeClass("zc-panel-quick-links-starter-button_active"),l(".zc-panel-quick-links").removeClass("zc-panel-quick-links_active"),this.service("close-block").hide()):(e.addClass("zc-panel-quick-links-starter-button_active"),l(".zc-panel-quick-links").addClass("zc-panel-quick-links_active"),this.service("close-block").show())}))}closeBlock(){l(window).on("zc/close-block.zc-panel",(()=>{l(".zc-panel-quick-links-starter-button").hasClass("zc-panel-quick-links-starter-button_active")&&(l(".zc-panel-quick-links-starter-button").removeClass("zc-panel-quick-links-starter-button_active"),l(".zc-panel-quick-links").removeClass("zc-panel-quick-links_active"),this.service("close-block").hide())}))}}zc.module.panel.addMode(((e,t)=>{const n=(t="",n)=>{e(".zc-panel-template__panel-loading-value").text(t),e(".zc-panel-template__panel-loading-progress-total").width(Math.floor(n)+"%")};e.ajax({type:"post",dataType:"html",url:ajaxurl,data:{action:"zc/module/panel/content_"+t.getVar("slug"),_ajax_nonce:t.getVar("nonce")},xhr:()=>{const e=new window.XMLHttpRequest;return e.addEventListener("progress",(t=>{if(t.lengthComputable&&t.total>0){const e=Math.floor(t.loaded/t.total*100);n(`${e} %`,e)}else{const i=e.getResponseHeader("X-Content-Length"),o=Math.floor(t.loaded/i*100);n(`${o} %`,o)}}),!1),e},error:e=>{t.errorCheck(" Panel : Content load",`Error - ${e.status} : ${e.statusText}`)},success:n=>{n<=0&&zc.confirm({title:"Error - AJAX",subject:"Error : Unable to connect to the AJAX module or you are not logged in. The page will reload, okay ?",titleOK:t.getVar("optionsResetOk"),titleCancel:t.getVar("optionsResetCancel"),class:"zc-panel-error-confirm",ok:()=>{location.reload()}}),e(".zc-panel-template").append(n),t.addConfig("wp-body-height",e(window).height()),t.closeBlock(),t.controlInit(),t.controlHelp(),t.scrollbar(),t.noMetaScaleIfMobile(),t.condition(),t.ifChanged(),t.tooltip(),t.menu(),new i;const o=new s;new r,t.addCache("option-handler",o),setTimeout((()=>{e(".zc-panel-template__panel-loading").hide(),e(".zc-panel").css("visibility","visible"),t.addCache("first-start",!0),e(window).trigger("zc/panel/show-content")}),50)}}),t.disableSaveButton=()=>{e(".zc-panel-save-starter-button").prop("disabled",!0).addClass("zc-panel-header__controller-button_disabled")},t.enableSaveButton=()=>{e(".zc-panel-save-starter-button").prop("disabled",!1).removeClass("zc-panel-header__controller-button_disabled")},t.disableResetButton=()=>{e(".zc-panel-reset-starter-button").prop("disabled",!0).addClass("zc-panel-header__controller-button_disabled")},t.enableResetButton=()=>{e(".zc-panel-reset-starter-button").prop("disabled",!1).removeClass("zc-panel-header__controller-button_disabled")}}))})();