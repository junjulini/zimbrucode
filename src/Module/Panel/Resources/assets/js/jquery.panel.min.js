(()=>{"use strict";const e=jQuery;class t{constructor(){this.global=zc.getModuleData("panel")}scrollbarTop(){e(".zc-panel .zc-scrollbar").scrollTop(0)}calcHeight(){this.getCache("wp-body-height")!==e(window).height()&&this.addCache("wp-body-height",e(window).height())}eraseMobileMenu(){this.isDesktopMode()?!0===this.service("menu/isSubmenuItem")&&(e(".zc-panel-menu").addClass("zc-panel-menu_submenu-active"),e(".zc-panel-content").addClass("zc-panel-content_submenu-active")):(e(".zc-panel-menu").removeClass("zc-panel-menu_submenu-active"),e(".zc-panel-content").removeClass("zc-panel-content_submenu-active")),e(".zc-panel-content").removeClass("zc-panel-content_mobile-menu-visible"),e(".zc-panel-header__controller-button_type_mobile-menu").removeClass("zc-panel-header__controller-button_type_mobile-menu_active"),this.service("close-block").hideDefinitely()}isDesktopMode(){return e(".zc-panel").width()>=this.getConfig("min-size/mode2")}errorCheck(t,n){e(".zc-popup").hasClass("zc-panel-error-confirm")||(e(".zc-popup").length&&e(".zc-popup").remove(),console.error(n),zc.confirm({title:t,subject:`${n} <br> Page will be reloaded, ok?`,class:"zc-panel-error-confirm",ok:()=>{location.reload()}}))}getVar(e,t){const n=zc.deepFindAndSetting(this.global.vars,e);return void 0!==n?n:t}addVar(e,t){zc.deepFindAndSetting(this.global.vars,e,t)}addCache(e,t){zc.deepFindAndSetting(this.global.cache,e,t)}getCache(e,t){const n=zc.deepFindAndSetting(this.global.cache,e);return void 0!==n?n:t}remCache(e){zc.deepFindAndSetting(this.global.cache,e,!1,!0)}addConfig(e,t){zc.deepFindAndSetting(this.global.config,e,t)}getConfig(e,t){const n=zc.deepFindAndSetting(this.global.config,e);return void 0!==n?n:t}service(t,n){if(void 0!==t&&"string"==typeof t){if(!e.isFunction(n)&&"object"!=typeof n){const e=this.getCache(`services/${t}`,!1);if(void 0!==e)return e;throw new Error(`Next service not exist : ${t}`)}this.addCache(`services/${t}`,n)}}on(t,n,a,i=!1){e(".zc-panel").on(t,n,(t=>{!0===i&&t.preventDefault(),a(e(t.currentTarget),t)}))}click(e,t,n=!0){this.on("click",e,t,n)}}const n=jQuery;class a extends t{constructor(){super(),this.isOpen=0,this.click(".zc-panel-controls__close-block",(()=>{n(window).trigger("zc/close-block")})),n(window).on("zc/close-block/show",(()=>{this.show()})),n(window).on("zc/close-block/hide",(()=>{this.hide()})),n(window).on("zc/close-block/hide-definitely",(()=>{this.hideDefinitely()}))}show(){n(".zc-panel-controls__close-block").addClass("zc-panel-controls__close-block_active"),this.isOpen++}hide(){1===this.isOpen?(n(".zc-panel-controls__close-block").removeClass("zc-panel-controls__close-block_active"),this.isOpen=0):(this.isOpen--,this.isOpen<0&&(this.isOpen=0))}hideDefinitely(){n(".zc-panel-controls__close-block").removeClass("zc-panel-controls__close-block_active"),this.isOpen=0,n(window).trigger("zc/close-block")}}const i=jQuery;class c{constructor(){this.callback={}}add(e,t,n){i.isFunction(t)&&(void 0===this.callback[e]&&(this.callback[e]=[]),this.callback[e].push({callback:t,additional:n}))}run(e){if(void 0!==e&&""!==e){const t=[].slice.apply(arguments);t.shift(),void 0!==this.callback[e]&&this.callback[e].forEach((e=>{const n=i.extend(!0,[],t);void 0!==e.additional&&n.push(e.additional),e.callback.apply(this,n)}))}}}const s=jQuery;class o extends t{constructor(){super(),this.isSubmenuItem=!1,this.menuItemID=!1,this.menuItem=!1,this.submenuItem=!1,this.menuParentItem=!1,this.desktop(),this.mobile()}removeSubmenuActive(){s(".zc-panel-menu").removeClass("zc-panel-menu_submenu-active"),s(".zc-panel-content").removeClass("zc-panel-content_submenu-active")}addSubmenuActive(){s(".zc-panel-menu").addClass("zc-panel-menu_submenu-active"),s(".zc-panel-content").addClass("zc-panel-content_submenu-active")}isSubmenuActive(){return s(".zc-panel-menu").hasClass("zc-panel-menu_submenu-active")&&s(".zc-panel-content").hasClass("zc-panel-content_submenu-active")}displaySection(e,t){const n=s(`.zc-panel-menu li[data-menu-item-id="${e}"]`),a=n.find("i").first().attr("class").match(/\bzc-icon\S+/g)[0];s(".zc-panel-header__title-icon").removeClass(((e,t)=>(t.match(/\bzc-icon\S+/g)||[]).join(" "))).addClass(a),s(".zc-panel-header__title").text(n.find("span").text()),this.menuItemID&&s(`.zc-panel-controls__section[data-section="${this.menuItemID}"]`).removeClass("zc-panel-controls__section_active");const i=s(`.zc-panel-controls__section[data-section="${e}"]`);if(i.addClass("zc-panel-controls__section_active"),s(window).trigger("zc/panel/menu/item-change"),this.addCache("menu/current-section",i),i.hasClass("zc-panel-controls__section_ICP")||(i.addClass("zc-panel-controls__section_ICP"),s(window).trigger("zc/panel/menu/item-change-ICP",[i])),n.parent().hasClass("zc-panel-submenu__list")){let e=n.parent().parent().parent().parent();e.hasClass("zc-panel-submenu__scrollbar-container")&&(e=e.parent()),e.addClass("zc-panel-submenu__container_active");const t=e.data("menu-container-id"),a=s(`.zc-panel-menu__item_type_parent[data-menu-container-id="${t}"]`);n.addClass("zc-panel-submenu__item_active"),a.addClass("zc-panel-menu__item_active"),this.isSubmenuActive()||this.addSubmenuActive(),this.isSubmenuItem=!0,this.submenuItem=e,this.menuParentItem=a}else n.addClass("zc-panel-menu__item_active"),this.isSubmenuActive()&&this.removeSubmenuActive(),this.isSubmenuItem=!1,this.submenuItem=!1,this.menuParentItem=!1;this.menuItem=n,this.menuItemID=e;const c=s(".zc-panel-content .zc-scrollbar");if(c.scrollTop(0),t){const n=s(`.zc-panel-controls [name=${this.getVar("prefix-slug")}${t}]`).closest(".zc-panel-controls__item");0!==n.length&&setTimeout((()=>{const e=c.css("position")||"absolute",t="absolute"==e?c:s("html, body"),a=s(".zc-panel-header");let i=a.offset().top||0;i+=a.height()||0,"absolute"==e&&(i+=c.height()/2);const o=n.offset().top-i;t.animate({scrollTop:o},"fast",(()=>{setTimeout((()=>{n.addClass("zc-panel-controls__item_visual-alert"),setTimeout((()=>{n.removeClass("zc-panel-controls__item_visual-alert")}),3e3)}),300)}))}),300),window.location.hash=e}}procMenuItem(e,t){this.isSubmenuItem?(this.menuItem.removeClass("zc-panel-submenu__item_active"),this.menuParentItem.removeClass("zc-panel-menu__item_active"),this.submenuItem.removeClass("zc-panel-submenu__container_active"),this.displaySection(e,t)):(this.menuItem.removeClass("zc-panel-menu__item_active"),this.displaySection(e,t))}desktop(){let e,t="";if(s.param.fragment()){t=s.param.fragment()||"";const n=this.getItemID(t);!1!==n&&(t=n.part1,e=n.part2)}if(0===s(`.zc-panel-menu li[data-menu-item-id="${t}"]`).length){let e=s(".zc-panel-menu__list .zc-panel-menu__item_type_simple").first();if(t=e.data("menu-item-id"),!t){const n=e.data("menu-container-id");e=s(`.zc-panel-submenu__container[data-menu-container-id=${n}] .zc-panel-submenu__item_type_simple`).first(),t=e.data("menu-item-id")}}this.displaySection(t,e),s(window).on("hashchange.zc-panel",(e=>{let t,n=s.param.fragment()?s.param.fragment():"";const a=this.getItemID(n);!1!==a&&(n=a.part1,t=a.part2),0===s(`.zc-panel-menu li[data-menu-item-id="${n}"]`).length&&(n=void 0),void 0!==n&&this.procMenuItem(n,t)})),this.click(".zc-panel-menu__item_type_parent",(e=>{const t=e.data("menu-container-id"),n=s(`.zc-panel-submenu__container[data-menu-container-id=${t}] .zc-panel-submenu__item_type_simple`).first().data("menu-item-id");void 0!==n&&(window.location.hash=n)})),this.click(".zc-panel-menu__item_type_simple:not(.zc-panel-menu__item_active)",(e=>{const t=e.data("menu-item-id");void 0!==t&&(window.location.hash=t)})),this.click(".zc-panel-submenu__item_type_simple:not(.zc-panel-submenu__item_active)",(e=>{const t=e.data("menu-item-id");t&&(window.location.hash=t)}))}mobile(){this.click(".zc-panel-header__controller-button_type_mobile-menu",(e=>{if(e.hasClass("zc-panel-header__controller-button_type_mobile-menu_active"))e.removeClass("zc-panel-header__controller-button_type_mobile-menu_active"),s(".zc-panel-content").removeClass("zc-panel-content_mobile-menu-visible"),e.one("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",(()=>{s(".zc-panel-controls").height("auto")})),this.service("close-block").hideDefinitely();else{e.addClass("zc-panel-header__controller-button_type_mobile-menu_active"),s(".zc-panel-content").addClass("zc-panel-content_mobile-menu-visible");let t=s(".zc-panel-menu__container").height(),n=s(".zc-panel-menu__list").height()+this.getConfig("height-FAH");t>n&&(n=t),n>s(".zc-panel-controls").height()&&(s(".zc-panel-controls").height(n-this.getConfig("height-FAH")),s(".zc-panel-submenu__scrollbar-container").height(n-this.getConfig("header-height")));let a=s.param.fragment()?s.param.fragment():"";0===s(`.zc-panel-menu li[data-menu-item-id="${a}"]`).length&&(a=void 0),void 0!==a&&this.procMenuItem(a),this.service("close-block").show(),this.scrollbarTop()}})),s(window).on("zc/close-block.zc-panel",(()=>{s(".zc-panel-header__controller-button_type_mobile-menu").hasClass("zc-panel-header__controller-button_type_mobile-menu_active")&&(s(".zc-panel-header__controller-button_type_mobile-menu").removeClass("zc-panel-header__controller-button_type_mobile-menu_active"),s(".zc-panel-content").removeClass("zc-panel-content_mobile-menu-visible"),s(".zc-panel-header__controller-button_type_mobile-menu").one("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",(()=>{s(".zc-panel-controls").height("auto")})),this.service("close-block").hideDefinitely())})),this.click(".zc-panel-submenu__header-section_mode_mobile",(()=>{this.removeSubmenuActive(),this.scrollbarTop(),window.location.hash=""}))}getItemID(e){if(e&&-1!=e.indexOf("/")){const t=zc.strstr(e,"/",!0),n=zc.strReplace(["/"],[""],zc.strstr(e,"/",!1));if(t&&n)return{part1:t,part2:n}}return!1}}const l=jQuery;class r extends t{constructor(){super(),this.regex=/(.+?):(notEmpty|empty|is|not|contains|<|<=|>|>=)\((.*?)\),?/g,this.controlsNodes=new Map,this.cache=new Map,this.dataCaching(),this.firstStart(),this.onChange()}dataCaching(){document.querySelectorAll(".zc-panel .zc-panel-controls [data-option]").forEach((e=>{let t=e.getAttribute("name");null===t&&(t=e.getAttribute("id")),null!==t&&this.controlsNodes.set(t,e)})),document.querySelectorAll(".zc-panel .zc-panel-controls [data-condition]").forEach((e=>{let t;for(;t=this.regex.exec(e.dataset.condition);){let n=this.getVar("prefix-slug")+t[1];n&&(!1===this.cache.has(n)&&this.cache.set(n,new Map),this.cache.get(n).set(e,e))}}))}firstStart(){this.cache.forEach((e=>{e.forEach((e=>{this.parse(l(e),!0)}))}))}onChange(){l(".zc-panel .zc-panel-controls").on("change","[data-option]",(e=>{e.preventDefault(),e.stopPropagation();const t=l(e.currentTarget);let n=t.attr("name")||"";return n=n.replace("[]",""),this.cache.has(n)&&this.cache.get(n).forEach((e=>{this.parse(l(e))})),void 0===t.data("i")&&(t.hasClass("wp-editor-area")?!0===this.getCache("mce-loaded")&&(this.addCache("changed",!0),l(window).trigger("zc/panel/if-changed")):(this.addCache("changed",!0),l(window).trigger("zc/panel/if-changed"))),!1}))}parse(e,t){let n,a=this.prepConditions(e.data("condition")),i=(e.data("condition-operator")||"and").toLowerCase();l.each(a,((e,t)=>{const a=this.getVar("prefix-slug")+t.check;if(this.controlsNodes.has(a)){let e;const c=l(this.controlsNodes.get(a)),s=null!==c.val()?c.val().toString():"",o=t.value.toString();switch(t.rule){case"<":e=parseInt(s)<parseInt(o);break;case"<=":e=parseInt(s)<=parseInt(o);break;case">":e=parseInt(s)>parseInt(o);break;case">=":e=parseInt(s)>=parseInt(o);break;case"contains":e=-1!==s.indexOf(o);break;case"is":e=s==o;break;case"not":e=s!=o;break;case"notEmpty":e=!!s;break;case"empty":e=!s}void 0===n&&(n=e),n="or"===i?n||e:n&&e}})),t&&void 0!==t?n?(e.addClass("zc-panel-controls__item_show"),e.data("condition-show",!0)):(e.addClass("zc-panel-controls__item_hide"),e.data("condition-show",!1)):n?!0!==e.data("condition-show")&&(e.removeClass("zc-panel-controls__item_hide"),e.addClass("zc-panel-controls__item_show"),e.data("condition-show",!0)):!1!==e.data("condition-show")&&(e.removeClass("zc-panel-controls__item_show"),e.addClass("zc-panel-controls__item_hide"),e.data("condition-show",!1))}prepConditions(e){let t,n=[];for(;t=this.regex.exec(e);)n.push({check:t[1],rule:t[2],value:t[3]||""});return n}is(e,t){return(e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.oMatchesSelector).call(e,t)}}const h=jQuery;class d extends t{constructor(){super(),this.global.cache={changed:!1,services:{}},this.global.config={"right-margin":{desktop:20,mobile:10},"bottom-margin":42,"footer-height":56,"header-height":56,"height-FAH":112,"wp-body-height":0,"min-size":{"body-height":500,mode1:490,mode2:950},"wp-admin-bar-height":32},this.global.vars=zcPanelVars,this.service("callback",new c)}checkBrowserCompatibility(){try{new IntersectionObserver((e=>{})),new ResizeObserver((e=>{}))}catch(e){throw this.getVar("browser-error-subject")}}menu(){this.service("menu",new o)}closeBlock(){this.service("close-block",new a)}scrollbar(){if(!zc.isMobile()&&-1==navigator.userAgent.indexOf("Firefox")){const e={checkIfActive:(e,t)=>{const n=Math.round(e.outerHeight(!0)),a=Math.round(t.outerHeight(!0));n>0&&(a>n?e.addClass("zc-scrollbar_active"):e.removeClass("zc-scrollbar_active"))}};e.ro=new ResizeObserver((t=>{void 0!==t[0]&&t.forEach((t=>{e.checkIfActive(h(t.target).parent(),h(t.target))}))})),h(".zc-panel .zc-scrollbar").each(((t,n)=>{e.ro.observe(h(n).children().first().get(0))})),h(window).on("zc/panel/size-changed",(()=>{h(".zc-panel .zc-scrollbar").each(((t,n)=>{e.checkIfActive(h(n),h(n).children().first())}))}))}}noMetaScaleIfMobile(){zc.isMobile()&&h("head meta[name=viewport]").attr("content","width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0")}condition(){new r(this)}ifChanged(){h(document).on("click","#publishing-action #publish",(()=>{this.addCache("changed",!1)})),h(window).on("beforeunload.zc-panel",(()=>{if(this.getCache("changed"))return this.getVar("if-changed")}))}controlHelp(){const e={width:600,height:250};this.click(".zc-panel-help__starter_type_simple",(t=>{let n=t.data("settings");void 0!==n&&""!==n&&null!=n||(n={}),e.title=t.attr("title"),e.html=t.parent().find(".zc-panel-help__content").text(),zc.popup().add(h.extend({},e,n))}))}controlInit(){this.service("callback").run("control",h,this)}tooltip(){!1===zc.isMobile()&&h(".zc-panel [data-tooltip]").tipsy({title:"data-tooltip",gravity:function(){var e=h(this).data("tooltip-position");if(!e)return"n";switch(e){case"top":return"s";case"right":return"w";case"bottom":default:return"n";case"left":return"e"}},on:!0,offset:3,opacity:1})}}zc.addModule("panel",(e=>{const t=new d;return e((()=>{try{if(void 0===t.mode)throw"panel.mode is undefined";if(!e.isFunction(t.mode))throw"panel.mode is not function";t.checkBrowserCompatibility(),t.mode(e,t)}catch(n){e(".zc-panel-template").length>0?e(".zc-panel-template").empty().append(`<div class="error notice"><p><b>${t.getVar("browser-error-title")}</b> : ${n}</p></div>`):(e("#wpbody-content").prepend(`<div class="error notice"><p><b>${t.getVar("browser-error-title")}</b> : ${n}</p></div>`),alert(`${t.getVar("browser-error-title")} : ${n}`))}})),{addControl:e=>{const n=document.getElementsByTagName("script"),a=n[n.length-1].src.split("/"),i=a[a.length-5],c=t.getVar("controls")[i];t.service("callback").add("control",e,c)},addMode:e=>{t.mode=e}}}))})();